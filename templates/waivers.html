<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIU Waivers</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="/static/css/styles.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
    <nav class="navbar text-white p-4">
        <div class="container mx-auto flex justify-between">
            <h1 class="text-2xl font-bold">DIU Admission Portal</h1>
            <div>
                <a href="/" class="mx-2">Home</a>
                <a href="/programs_page" class="mx-2">Programs</a>
                <a href="/recommendations_page" class="mx-2">Recommendations</a>
                <a href="/application_page" class="mx-2">Application</a>
                <a href="/chat_page" class="mx-2">Chat</a>
                <a href="/dashboard_page" class="mx-2">Dashboard</a>
            </div>
        </div>
    </nav>
    <div class="container mx-auto p-8">
        <h2 class="text-3xl font-bold mb-4">Waiver Calculator</h2>
        <form id="waiver-form" class="space-y-4">
            <div>
                <label class="block">Department:</label>
                <select name="faculty" class="form-input">
                    <option value="ICE">Information and Communication Engineering</option>
                    <option value="CSE">Computer Science and Engineering</option>
                    <option value="EEE">Electrical and Electronic Engineering</option>
                    <option value="TE">Textile Engineering</option>
                    <option value="BBA">Business Administration</option>
                    <option value="LLB">Law</option>
                    <option value="B.PHARM">Pharmacy</option>
                    <option value="ARCH">Architecture</option>
                    <option value="ENG">English</option>
                    <option value="PH">Public Health</option>
                    <option value="SWE">Software Engineering</option>
                    <option value="CE">Civil Engineering</option>
                    <option value="ESM">Environmental Science and Management</option>
                    <option value="THM">Tourism and Hospitality Management</option>
                    <option value="NFE">Nutrition and Food Engineering</option>
                    <option value="JMC">Journalism and Mass Communication</option>
                </select>
            </div>
            <div>
                <label class="block">SSC GPA:</label>
                <input type="number" name="ssc_gpa" step="0.01" min="0" max="5" class="form-input">
            </div>
            <div>
                <label class="block">HSC GPA:</label>
                <input type="number" name="hsc_gpa" step="0.01" min="0" max="5" class="form-input">
            </div>
            <div>
                <label class="block">Family Income (BDT/month):</label>
                <input type="number" name="family_income" class="form-input">
            </div>
            <div>
                <label class="block">Freedom Fighter Child:</label>
                <input type="checkbox" name="is_freedom_fighter_child" class="form-input">
            </div>
            <div>
                <label class="block">DIU Employee Relative:</label>
                <input type="checkbox" name="is_diu_employee_relative" class="form-input">
            </div>
            <div>
                <label class="block">Sports Achievement:</label>
                <input type="checkbox" name="has_sports_achievement" class="form-input">
            </div>
            <div>
                <label class="block">Diploma Holder:</label>
                <input type="checkbox" name="has_diploma" class="form-input">
            </div>
            <div>
                <label class="block">International Student:</label>
                <input type="checkbox" name="is_international_student" class="form-input">
            </div>
            <div>
                <label class="block">Group Admission (5+ students):</label>
                <input type="checkbox" name="group_admission" class="form-input">
            </div>
            <button type="submit" class="btn-primary">Calculate Waivers</button>
        </form>
        <div id="waiver-results" class="mt-4"></div>
    </div>
    <script>
        document.getElementById('waiver-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = {
                faculty: formData.get('faculty'),
                ssc_gpa: parseFloat(formData.get('ssc_gpa')),
                hsc_gpa: parseFloat(formData.get('hsc_gpa')),
                is_new_student: true,
                student_profile: {
                    family_income: parseFloat(formData.get('family_income')) || null,
                    is_freedom_fighter_child: formData.get('is_freedom_fighter_child') === 'on',
                    is_diu_employee_relative: formData.get('is_diu_employee_relative') === 'on',
                    has_sports_achievement: formData.get('has_sports_achievement') === 'on',
                    has_diploma: formData.get('has_diploma') === 'on',
                    is_international_student: formData.get('is_international_student') === 'on',
                    group_admission: formData.get('group_admission') === 'on'
                }
            };
            try {
                const response = await fetch('/waivers/recommend', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                const results = await response.json();
                const resultsDiv = document.getElementById('waiver-results');
                resultsDiv.innerHTML = results.map(w => `
                    <div class="card bg-white p-4 rounded shadow mb-2">
                        <p><strong>${w.name}</strong> (${w.category})</p>
                        <p>${w.description}</p>
                        <p><strong>Waiver:</strong> ${w.waiver_percentage}</p>
                        <p><strong>Eligibility:</strong> ${w.eligibility_criteria.join(', ')}</p>
                        <p><strong>Required Documents:</strong> ${w.required_documents.join(', ')}</p>
                        <p><strong>Applicable Programs:</strong> ${w.applicable_programs.join(', ')}</p>
                        <p><strong>SGPA Required:</strong> ${w.sgpa_required}</p>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error:', error);
            }
        });
    </script>
</body>
</html>